<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EmailPro Validator</title>
    <link rel="shortcut icon" href="email.png" type="image/png">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --info: #4895ef;
            --dark: #252422;
            --light: #f8f9fa;
            --gradient: linear-gradient(135deg, var(--primary), var(--info));
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        header {
            background: var(--gradient);
            color: white;
            padding: 1.5rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo-icon {
            font-size: 2rem;
        }

        main {
            flex: 1;
            padding: 2rem 0;
        }

        .hero {
            text-align: center;
            margin-bottom: 3rem;
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero p {
            font-size: 1.2rem;
            color: #555;
            max-width: 700px;
            margin: 0 auto;
        }

        .validator-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            padding: 2.5rem;
            max-width: 800px;
            margin: 0 auto;
            margin-bottom: 3rem;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .validator-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .input-group {
            position: relative;
            margin-bottom: 2rem;
        }

        .input-group input {
            width: 100%;
            padding: 1rem 1.5rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(67, 97, 238, 0.1);
        }

        .input-group label {
            position: absolute;
            top: -10px;
            left: 15px;
            background: white;
            padding: 0 10px;
            font-size: 0.9rem;
            color: #777;
        }

        .validate-btn {
            width: 100%;
            background: var(--gradient);
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
        }

        .validate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .validate-btn:hover:not(:disabled) {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .result-container {
            margin-top: 2rem;
            padding: 1.5rem;
            border-radius: 8px;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-valid {
            background-color: rgba(76, 201, 240, 0.1);
            border: 1px solid var(--success);
        }

        .result-invalid {
            background-color: rgba(247, 37, 133, 0.1);
            border: 1px solid var(--danger);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .result-icon {
            font-size: 2rem;
        }

        .valid-icon {
            color: var(--success);
        }

        .invalid-icon {
            color: var(--danger);
        }

        .result-title {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .feature-section {
            padding: 3rem 0;
            background-color: #f9f9f9;
        }

        .section-title {
            text-align: center;
            margin-bottom: 2.5rem;
            font-size: 2rem;
            color: var(--dark);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
        }

        .feature-card {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        .feature-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--gradient);
            color: white;
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }

        .feature-title {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        .feature-desc {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }

        footer {
            background-color: var(--dark);
            color: white;
            padding: 3rem 0 1.5rem;
        }

        .footer-content {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-col {
            flex: 1;
            min-width: 200px;
        }

        .footer-title {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.75rem;
        }

        .footer-links a {
            color: #bbb;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: white;
        }

        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .social-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.3s;
        }

        .social-icon:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }

        .copyright {
            text-align: center;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #999;
        }

        .loader {
            display: none;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .progress-container {
            margin-top: 2rem;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .progress-bar {
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient);
            width: 0%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .progress-text {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: #777;
            text-align: center;
        }

        .history-section {
            margin-top: 3rem;
            display: none;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .history-title {
            font-size: 1.5rem;
            color: var(--dark);
        }

        .clear-history-btn, .export-history-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
            transition: opacity 0.3s;
        }

        .clear-history-btn {
            color: var(--danger);
        }

        .export-history-btn {
            color: var(--primary);
            margin-right: 1rem;
        }

        .clear-history-btn:hover, .export-history-btn:hover {
            opacity: 0.8;
        }

        .table-wrapper {
            overflow-x: auto;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .history-table th, .history-table td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .history-table th {
            background-color: #f9f9f9;
            font-weight: 600;
            color: #555;
        }

        .history-table tr:hover {
            background-color: #f9f9f9;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .badge-valid {
            background-color: rgba(76, 201, 240, 0.15);
            color: var(--success);
        }

        .badge-invalid {
            background-color: rgba(247, 37, 133, 0.15);
            color: var(--danger);
        }

        .view-details-btn, .remove-history-btn {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 0.9rem;
            margin-right: 0.5rem;
            transition: opacity 0.3s;
        }

        .remove-history-btn {
            color: var(--danger);
        }

        .view-details-btn:hover, .remove-history-btn:hover {
            opacity: 0.8;
        }

        .theme-toggle {
            position: relative;
            width: 60px;
            height: 30px;
            border-radius: 15px;
            background-color: rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .toggle-thumb {
            position: absolute;
            left: 4px;
            top: 4px;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background-color: white;
            transition: transform 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .dark-mode .toggle-thumb {
            transform: translateX(30px);
        }

        .dark-mode {
            background-color: #121212;
            color: #f5f5f5;
        }

        .dark-mode .validator-card, 
        .dark-mode .feature-card {
            background-color: #1e1e1e;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
        }

        .dark-mode .input-group input {
            background-color: #2d2d2d;
            border-color: #444;
            color: white;
        }

        .dark-mode .input-group label {
            background-color: #1e1e1e;
            color: #bbb;
        }

        .dark-mode .feature-section {
            background-color: #181818;
        }

        .dark-mode .section-title, 
        .dark-mode .feature-title {
            color: #f5f5f5;
        }

        .dark-mode .feature-desc {
            color: #bbb;
        }

        .dark-mode .history-table th {
            background-color: #222;
            color: #ddd;
        }

        .dark-mode .history-table td {
            border-bottom-color: #333;
        }

        .dark-mode .history-table tr:hover {
            background-color: #252525;
        }

        #history-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        #history-modal.show {
            visibility: visible;
            opacity: 1;
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .dark-mode .modal-content {
            background: #2d2d2d;
            color: white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .close-modal {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            font-size: 1.5rem;
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .validator-card {
                padding: 1.5rem;
            }

            .table-wrapper {
                overflow-x: auto;
            }
        }

        @media (max-width: 480px) {
            .validator-card {
                padding: 1rem;
            }

            .hero h1 {
                font-size: 1.8rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .input-group input {
                padding: 0.8rem 1rem;
            }

            .validate-btn {
                padding: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo">
                    <span class="logo-icon">‚úâÔ∏è</span>
                    <span>EmailPro Validator</span>
                </div>
                <div class="theme-toggle">
                    <div class="toggle-thumb">‚òÄÔ∏è</div>
                </div>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <section class="hero">
                <h1>Advanced Email Validation Tool</h1>
                <p>Validate any email address with our powerful, accurate, and comprehensive email validation system</p>
            </section>

            <section class="validator-section">
                <div class="validator-card">
                    <form id="validator-form">
                        <div class="input-group">
                            <label for="email-input">Email Address</label>
                            <input type="text" id="email-input" placeholder="Enter email address to validate">
                        </div>
                        <button type="submit" class="validate-btn" id="validate-btn">
                            <span>Validate Email</span>
                            <div class="loader"></div>
                        </button>
                    </form>

                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                        <div class="progress-text">Validating email address...</div>
                    </div>

                    <div class="result-container" id="result-container">
                        <div class="result-header">
                            <span class="result-icon" id="result-icon"></span>
                            <h3 class="result-title" id="result-title"></h3>
                        </div>
                    </div>
                </div>

                <div class="history-section" id="history-section">
                    <div class="history-header">
                        <h3 class="history-title">Recent Validations</h3>
                        <div>
                            <button class="export-history-btn">Export History</button>
                            <button class="clear-history-btn">Clear History</button>
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>Email Address</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="history-table-body"></tbody>
                        </table>
                    </div>
                </div>

                <div id="history-modal">
                    <div class="modal-content">
                        <span class="close-modal">√ó</span>
                        <h3>Validation Details</h3>
                        <p><strong>Email:</strong> <span id="modal-email"></span></p>
                        <p><strong>Status:</strong> <span id="modal-status"></span></p>
                        <p><strong>Date:</strong> <span id="modal-date"></span></p>
                        <div id="modal-details"></div>
                    </div>
                </div>
            </section>

            <section class="feature-section" id="features">
                <h2 class="section-title">Advanced Features</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">üìù</div>
                        <h3 class="feature-title">Syntax Validation</h3>
                        <p class="feature-desc">Checks email format against standards.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üåê</div>
                        <h3 class="feature-title">Domain Verification</h3>
                        <p class="feature-desc">Ensures domain has mail servers.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üõ°Ô∏è</div>
                        <h3 class="feature-title">Disposable Detection</h3>
                        <p class="feature-desc">Detects temporary email addresses.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üîí</div>
                        <h3 class="feature-title">Typo Detection</h3>
                        <p class="feature-desc">Suggests corrections for common typos.</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="copyright">
                <p>¬© 2025 EmailPro Validator. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
document.addEventListener('DOMContentLoaded', function() {
    // DOM Elements
    const validatorForm = document.getElementById('validator-form');
    const emailInput = document.getElementById('email-input');
    const validateBtn = document.getElementById('validate-btn');
    const loader = document.querySelector('.loader');
    const progressContainer = document.querySelector('.progress-container');
    const progressFill = document.getElementById('progress-fill');
    const resultContainer = document.getElementById('result-container');
    const resultIcon = document.getElementById('result-icon');
    const resultTitle = document.getElementById('result-title');
    const themeToggle = document.querySelector('.theme-toggle');
    const toggleThumb = document.querySelector('.toggle-thumb');
    const historySection = document.getElementById('history-section');
    const historyTableBody = document.getElementById('history-table-body');
    const clearHistoryBtn = document.querySelector('.clear-history-btn');
    const exportHistoryBtn = document.querySelector('.export-history-btn');
    const historyModal = document.getElementById('history-modal');
    const closeModal = document.querySelector('.close-modal');
    const errorMessage = document.getElementById('error-message');

    // Initialize button state
    validateBtn.disabled = true;

    // Theme toggle functionality
    themeToggle.addEventListener('click', () => {
        document.body.classList.toggle('dark-mode');
        toggleThumb.innerHTML = document.body.classList.contains('dark-mode') ? 'üåô' : '‚òÄÔ∏è';
        localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
    });

    // Apply saved theme preference
    if (localStorage.getItem('theme') === 'dark') {
        document.body.classList.add('dark-mode');
        toggleThumb.innerHTML = 'üåô';
    }

    // Load validation history on page load
    loadValidationHistory();

    // Email input validation
    emailInput.addEventListener('input', function() {
        const email = this.value.trim();
        validateBtn.disabled = !email;
        
        if (errorMessage) {
            errorMessage.textContent = '';
            errorMessage.style.display = 'none';
        }
    });

    // Form submission handler
    validatorForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const email = emailInput.value.trim();
        if (!email) {
            showError('Please enter an email address');
            return;
        }
        validateEmail(email);
    });

    // Clear history button handler
    clearHistoryBtn.addEventListener('click', function() {
        if (confirm('Are you sure you want to clear the validation history?')) {
            localStorage.removeItem('emailValidationHistory');
            historyTableBody.innerHTML = '';
            historySection.style.display = 'none';
        }
    });

    // Export history button handler
    exportHistoryBtn.addEventListener('click', exportValidationHistory);

    // Modal close button handler
    closeModal.addEventListener('click', function() {
        historyModal.classList.remove('show');
    });

    // Close modal when clicking outside
    historyModal.addEventListener('click', function(e) {
        if (e.target === historyModal) {
            historyModal.classList.remove('show');
        }
    });

    // Display error message
    function showError(message) {
        if (errorMessage) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
        } else {
            alert(message);
        }
    }

    // Validate email with animation
    function validateEmail(email) {
        validateBtn.querySelector('span').style.display = 'none';
        loader.style.display = 'block';
        resultContainer.style.display = 'none';
        progressContainer.style.display = 'block';

        // Reset progress
        progressFill.style.width = '0%';

        let progress = 0;
        const progressInterval = setInterval(() => {
            progress += 5;
            progressFill.style.width = `${progress}%`;
            if (progress >= 100) {
                clearInterval(progressInterval);
                setTimeout(() => {
                    displayValidationResults(email);
                }, 300);
            }
        }, 100);
    }

    // Display validation results
    function displayValidationResults(email) {
        validateBtn.querySelector('span').style.display = 'inline';
        loader.style.display = 'none';
        progressContainer.style.display = 'none';

        try {
            const validationResults = performEmailValidation(email);

            resultContainer.style.display = 'block';
            resultContainer.classList.remove('result-valid', 'result-invalid', 'result-warning');
            
            let resultClass = 'result-invalid';
            if (validationResults.isValid) {
                resultClass = 'result-valid';
            } else if (validationResults.warning) {
                resultClass = 'result-warning';
            }
            resultContainer.classList.add(resultClass);

            resultIcon.classList.remove('valid-icon', 'invalid-icon', 'warning-icon');
            let iconClass = 'invalid-icon';
            let iconSymbol = '‚ùå';
            
            if (validationResults.isValid) {
                iconClass = 'valid-icon';
                iconSymbol = '‚úÖ';
            } else if (validationResults.warning) {
                iconClass = 'warning-icon';
                iconSymbol = '‚ö†Ô∏è';
            }
            
            resultIcon.classList.add(iconClass);
            resultIcon.innerHTML = iconSymbol;

            resultTitle.innerText = validationResults.isValid ? 'Valid' : (validationResults.warning ? 'Warning' : 'Invalid');

            // Create and display detailed results
            if (document.getElementById('result-details')) {
                const detailsContainer = document.getElementById('result-details');
                detailsContainer.innerHTML = '';
                
                validationResults.details.forEach(detail => {
                    const detailItem = document.createElement('div');
                    detailItem.classList.add('detail-item');
                    detailItem.classList.add(detail.isValid ? 'valid-detail' : (detail.warning ? 'warning-detail' : 'invalid-detail'));
                    
                    const icon = document.createElement('span');
                    icon.classList.add('detail-icon');
                    icon.innerText = detail.isValid ? '‚úì' : (detail.warning ? '‚ö†Ô∏è' : '‚úó');
                    
                    const text = document.createElement('span');
                    text.classList.add('detail-text');
                    text.innerText = detail.message;
                    
                    detailItem.appendChild(icon);
                    detailItem.appendChild(text);
                    detailsContainer.appendChild(detailItem);
                });
            }

            saveToHistory(email, validationResults);
            loadValidationHistory();
        } catch (error) {
            showError(`Validation error: ${error.message}`);
        }
    }

    // Core email validation logic
    function performEmailValidation(email) {
        // Check if email is provided
        if (!email) {
            throw new Error('Email is required');
        }

        // Basic email parts check
        const parts = email.split('@');
        if (parts.length !== 2 || !parts[0] || !parts[1]) {
            return {
                isValid: false,
                warning: false,
                details: [
                    { name: 'Format', isValid: false, message: 'Email must contain exactly one @ symbol with content before and after' }
                ]
            };
        }

        const localPart = parts[0];
        const domain = parts[1];

        // Advanced Format Validation using RFC 5322 compliant regex
        const formatRegex = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        const isFormatValid = formatRegex.test(email);

        // Length validation
        const isLocalPartLengthValid = localPart.length <= 64;
        const isDomainLengthValid = domain.length <= 255;
        const isTotalLengthValid = email.length <= 254;
        const isLengthValid = isLocalPartLengthValid && isDomainLengthValid && isTotalLengthValid;
        
        // Local part validation
        const localPartRegex = /^[a-zA-Z0-9!#$%&'*+\-/=?^_`{|}~.]+$/;
        const isLocalPartValid = localPartRegex.test(localPart) && !localPart.startsWith('.') && !localPart.endsWith('.') && !localPart.includes('..');
        
        // Domain validation
        const domainRegex = /^[a-zA-Z0-9](?:[a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?)*$/;
        const isDomainValid = domainRegex.test(domain);
        
        // TLD validation
        const tld = domain.split('.').pop();
        const isValidTLD = tld && tld.length >= 2;
        
        // Disposable domain check
        const disposableDomains = [
            'mailinator.com', 'tempmail.com', 'throwawaymail.com', '10minutemail.com', 
            'guerrillamail.com', 'yopmail.com', 'mailnesia.com', 'temp-mail.org',
            'fakeinbox.com', 'tempinbox.com', 'emailfake.com', 'sharklasers.com',
            'dispostable.com', 'maildrop.cc', 'getairmail.com', 'getnada.com',
            'temp-mail.io', 'trashmail.com', 'spamgourmet.com', 'mytemp.email'
        ];
        const isDisposable = disposableDomains.includes(domain.toLowerCase());
        
        // Common typo detection
        const commonTypos = {
            "gamil.com": "gmail.com",
            "gmial.com": "gmail.com",
            "gmali.com": "gmail.com",
            "gmil.com": "gmail.com",
            "gmai.com": "gmail.com",
            "gmal.com": "gmail.com",
            "gmail.co": "gmail.com",
            "yahho.com": "yahoo.com",
            "yaho.com": "yahoo.com",
            "yahooo.com": "yahoo.com",
            "yaoo.com": "yahoo.com",
            "yhaoo.com": "yahoo.com",
            "hotmal.com": "hotmail.com",
            "hotmial.com": "hotmail.com",
            "hotmali.com": "hotmail.com",
            "hotmil.com": "hotmail.com",
            "hotmai.com": "hotmail.com",
            "hotnail.com": "hotmail.com",
            "outlok.com": "outlook.com",
            "outloo.com": "outlook.com",
            "outllok.com": "outlook.com",
            "outloook.com": "outlook.com"
        };
        const isTypo = commonTypos.hasOwnProperty(domain.toLowerCase());
        const suggestedDomain = isTypo ? commonTypos[domain.toLowerCase()] : null;
        
        // Simulated MX record check (would be replaced with actual API in production)
        // In a real implementation, this would be a server-side API call to check DNS records
        const hasMxRecords = getSimulatedMxStatus(domain);
        
        // Role-based email detection
        const roleBasedLocalParts = [
            'info', 'support', 'admin', 'sales', 'contact', 'help', 'team', 'office',
            'marketing', 'billing', 'service', 'mail', 'webmaster', 'postmaster',
            'hostmaster', 'abuse', 'noc', 'security', 'no-reply', 'noreply', 'hr'
        ];
        const isRoleBased = roleBasedLocalParts.includes(localPart.toLowerCase());
        
        // Free email provider detection
        const freeEmailDomains = [
            'gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com', 'aol.com',
            'icloud.com', 'mail.com', 'protonmail.com', 'zoho.com', 'yandex.com',
            'gmx.com', 'live.com', 'mail.ru', 'inbox.com', 'tutanota.com'
        ];
        const isFreeProvider = freeEmailDomains.includes(domain.toLowerCase());
        
        // Temporary domain detection
        const temporaryDomains = ['mailinator.com', 'tempmail.com', 'temp-mail.org'];
        const isTemporary = temporaryDomains.includes(domain.toLowerCase());
        
        // Mailbox existence simulation (would be an actual API call in production)
        // In a real implementation, this would be a server-side SMTP call to verify the mailbox
        const isMailboxValid = simulateMailboxValidation(email, isFormatValid, hasMxRecords);
        
        // Spam trap detection (simulated)
        const isSpamTrap = email.includes('spam') || email.includes('trap');
        
        // Determine overall validity
        // Crucial failures (make email invalid)
        const crucialChecks = isFormatValid && isLengthValid && isLocalPartValid && isDomainValid && isValidTLD;
        
        // Warning conditions (email is usable but with caution)
        const hasWarnings = isDisposable || isRoleBased || isTypo || !hasMxRecords || !isMailboxValid;
        
        // Final validity determination
        const isValid = crucialChecks && !isSpamTrap && !isTemporary;
        
        // Detailed results for display
        const details = [
            { 
                name: 'Format', 
                isValid: isFormatValid, 
                warning: false,
                message: isFormatValid ? 'Valid email format' : 'Invalid email format' 
            },
            { 
                name: 'Length', 
                isValid: isLengthValid, 
                warning: false,
                message: isLengthValid ? 'Valid length' : (
                    !isLocalPartLengthValid ? 'Local part exceeds 64 characters' : 
                    !isDomainLengthValid ? 'Domain exceeds 255 characters' : 
                    'Email exceeds 254 characters'
                )
            },
            { 
                name: 'Domain', 
                isValid: isDomainValid && isValidTLD, 
                warning: !hasMxRecords,
                message: !isDomainValid ? 'Invalid domain format' : 
                         !isValidTLD ? 'Invalid top-level domain' :
                         !hasMxRecords ? 'Domain lacks mail servers (MX records)' :
                         'Domain has valid mail servers' 
            }
        ];
        
        // Add mailbox validation result
        if (isFormatValid && isDomainValid && isValidTLD) {
            details.push({ 
                name: 'Mailbox', 
                isValid: isMailboxValid, 
                warning: !isMailboxValid,
                message: isMailboxValid ? 'Mailbox exists and is accepting mail' : 'Mailbox may not exist or is rejecting mail'
            });
        }
        
        // Add disposable email check
        if (isDisposable) {
            details.push({ 
                name: 'Disposable', 
                isValid: false, 
                warning: true,
                message: 'Disposable email detected - may not be reliable for long-term contact'
            });
        }
        
        // Add temporary email check
        if (isTemporary) {
            details.push({ 
                name: 'Temporary', 
                isValid: false, 
                warning: false,
                message: 'Temporary email detected - not suitable for registration'
            });
        }
        
        // Add typo check
        if (isTypo) {
            details.push({ 
                name: 'Typo Check', 
                isValid: false, 
                warning: true,
                message: `Possible typo in domain, did you mean "${suggestedDomain}"?`
            });
        }
        
        // Add role-based email check
        if (isRoleBased) {
            details.push({ 
                name: 'Role-based', 
                isValid: true, 
                warning: true,
                message: 'Role-based email detected - may not belong to a specific person'
            });
        }
        
        // Add free provider check
        if (isFreeProvider) {
            details.push({ 
                name: 'Provider Type', 
                isValid: true, 
                warning: false,
                message: 'Free email provider'
            });
        } else if (!isDisposable && !isTemporary) {
            details.push({ 
                name: 'Provider Type', 
                isValid: true, 
                warning: false,
                message: 'Corporate/Custom domain'
            });
        }
        
        // Add spam trap check
        if (isSpamTrap) {
            details.push({ 
                name: 'Spam Trap', 
                isValid: false, 
                warning: false,
                message: 'Potential spam trap detected'
            });
        }
        
        return { isValid, warning: !isValid && hasWarnings, details };
    }

    // Simulated MX record check (to be replaced with actual API in production)
    function getSimulatedMxStatus(domain) {
        // Common domains we know have MX records
        const knownValidDomains = [
            'gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com', 'aol.com',
            'icloud.com', 'protonmail.com', 'zoho.com', 'mail.com', 'yandex.com',
            'gmx.com', 'tutanota.com', 'mail.ru', 'microsoft.com', 'apple.com',
            'amazon.com', 'facebook.com', 'twitter.com', 'linkedin.com', 'google.com'
        ];
        
        // If it's a known domain, return true
        if (knownValidDomains.includes(domain.toLowerCase())) {
            return true;
        }
        
        // For domains we don't recognize, use a probability-based approach
        // In a real implementation, this would be replaced with an actual DNS lookup
        const domainLength = domain.length;
        const hasCommonTLD = /\.(com|org|net|edu|gov|mil|io|co|us|uk|ca|de|fr|au|jp)$/.test(domain.toLowerCase());
        
        // Domains with common TLDs and reasonable length are more likely to be valid
        if (hasCommonTLD && domainLength > 5 && domainLength < 20) {
            return Math.random() > 0.2; // 80% chance of having MX records
        }
        
        // Arbitrary domains have a lower chance
        return Math.random() > 0.5; // 50% chance of having MX records
    }

    // Simulate mailbox validation (to be replaced with actual SMTP check in production)
    function simulateMailboxValidation(email, isFormatValid, hasMxRecords) {
        if (!isFormatValid || !hasMxRecords) {
            return false;
        }
        
        const [localPart, domain] = email.split('@');
        
        // Common domains we can simulate with higher accuracy
        const commonDomains = ['gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com'];
        
        if (commonDomains.includes(domain.toLowerCase())) {
            // Simulate specific provider rules
            // Gmail: doesn't allow dots in local part for validation purposes
            if (domain.toLowerCase() === 'gmail.com') {
                const normalizedLocalPart = localPart.replace(/\./g, '').toLowerCase();
                // Common patterns that are unlikely to be real
                if (normalizedLocalPart.length < 5 || /^[a-z]+$/.test(normalizedLocalPart) || /^[0-9]+$/.test(normalizedLocalPart)) {
                    return false;
                }
            }
            
            // Return true for most reasonable looking emails on major providers
            return !/^(test|user|admin|info|support|noreply|no-reply|postmaster)$/.test(localPart.toLowerCase());
        }
        
        // For other domains, use heuristics
        // Very short local parts are less likely to be valid
        if (localPart.length < 3) {
            return Math.random() > 0.7;
        }
        
        // Excessively long local parts are suspicious
        if (localPart.length > 30) {
            return Math.random() > 0.6;
        }
        
        // Default case - reasonable probability of being valid
        return Math.random() > 0.3;
    }

    // Save validation result to history
    function saveToHistory(email, results) {
        let history = getValidationHistory();
        
        // Check if this email is already in history
        const existingIndex = history.findIndex(item => item.email.toLowerCase() === email.toLowerCase());
        
        // Create history entry
        const historyEntry = {
            email,
            isValid: results.isValid,
            warning: results.warning || false,
            date: new Date().toISOString(),
            details: results.details
        };
        
        // Update or add entry
        if (existingIndex !== -1) {
            history[existingIndex] = historyEntry;
        } else {
            history.unshift(historyEntry);
        }
        
        // Keep maximum 20 entries
        if (history.length > 20) {
            history = history.slice(0, 20);
        }
        
        // Save to localStorage
        try {
            localStorage.setItem('emailValidationHistory', JSON.stringify(history));
        } catch (error) {
            console.error('Error saving to history:', error);
        }
    }

    // Get validation history from localStorage
    function getValidationHistory() {
        try {
            return JSON.parse(localStorage.getItem('emailValidationHistory')) || [];
        } catch (error) {
            console.error('Error loading history:', error);
            return [];
        }
    }

    // Load and display validation history
    function loadValidationHistory() {
        const history = getValidationHistory();
        
        if (history.length > 0) {
            historySection.style.display = 'block';
            historyTableBody.innerHTML = '';
            
            history.forEach((entry, index) => {
                const row = document.createElement('tr');
                
                // Determine status class
                let statusClass = 'badge-invalid';
                let statusText = 'Invalid';
                
                if (entry.isValid) {
                    statusClass = 'badge-valid';
                    statusText = 'Valid';
                } else if (entry.warning) {
                    statusClass = 'badge-warning';
                    statusText = 'Warning';
                }
                
                row.innerHTML = `
                    <td>${entry.email}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td>${formatDate(new Date(entry.date))}</td>
                    <td>
                        <button class="view-details-btn" data-index="${index}">View Details</button>
                        <button class="remove-history-btn" data-index="${index}">Remove</button>
                    </td>
                `;
                historyTableBody.appendChild(row);
            });
            
            // Add event listeners to buttons
            attachHistoryButtonListeners();
        } else {
            historySection.style.display = 'none';
        }
    }

    // Format date for display
    function formatDate(date) {
        try {
            return date.toLocaleString(undefined, {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        } catch (error) {
            return 'Invalid date';
        }
    }

    // Attach event listeners to history buttons
    function attachHistoryButtonListeners() {
        document.querySelectorAll('.view-details-btn').forEach(button => {
            button.addEventListener('click', function() {
                const index = parseInt(this.getAttribute('data-index'));
                showHistoryDetails(index);
            });
        });

        document.querySelectorAll('.remove-history-btn').forEach(button => {
            button.addEventListener('click', function() {
                const index = parseInt(this.getAttribute('data-index'));
                removeHistoryItem(index);
            });
        });
    }

    // Show details modal for history item
    function showHistoryDetails(index) {
        const history = getValidationHistory();
        const entry = history[index];
        
        if (entry) {
            document.getElementById('modal-email').innerText = entry.email;
            
            // Set status text and class
            const statusElement = document.getElementById('modal-status');
            statusElement.innerText = entry.isValid ? 'Valid' : (entry.warning ? 'Warning' : 'Invalid');
            statusElement.className = '';
            statusElement.classList.add(
                entry.isValid ? 'status-valid' : (entry.warning ? 'status-warning' : 'status-invalid')
            );
            
            document.getElementById('modal-date').innerText = formatDate(new Date(entry.date));
            
            // Display details
            const detailsContainer = document.getElementById('modal-details');
            detailsContainer.innerHTML = '';
            
            entry.details.forEach(detail => {
                const detailElement = document.createElement('div');
                detailElement.classList.add('modal-detail-item');
                
                // Add appropriate class based on status
                if (!detail.isValid) {
                    detailElement.classList.add(detail.warning ? 'detail-warning' : 'detail-invalid');
                } else {
                    detailElement.classList.add('detail-valid');
                }
                
                detailElement.innerHTML = `
                    <span class="detail-icon">${detail.isValid ? '‚úì' : (detail.warning ? '‚ö†Ô∏è' : '‚úó')}</span>
                    <span class="detail-name">${detail.name}:</span>
                    <span class="detail-message">${detail.message}</span>
                `;
                
                detailsContainer.appendChild(detailElement);
            });
            
            // Show modal
            historyModal.classList.add('show');
        }
    }

    // Remove item from history
    function removeHistoryItem(index) {
        let history = getValidationHistory();
        
        try {
            // Remove the item
            history.splice(index, 1);
            
            // Save updated history
            localStorage.setItem('emailValidationHistory', JSON.stringify(history));
            
            // Refresh history display
            loadValidationHistory();
        } catch (error) {
            console.error('Error removing history item:', error);
            showError('Failed to remove history item');
        }
    }

    // Export validation history to CSV
    function exportValidationHistory() {
        const history = getValidationHistory();
        
        if (history.length === 0) {
            showError('No history to export');
            return;
        }
        
        try {
            // Generate CSV header
            let csvContent = 'Email,Status,Date,Details\n';
            
            // Add each history entry to CSV
            history.forEach(entry => {
                // Format details for CSV
                const details = entry.details
                    .map(d => `${d.name}: ${d.message.replace(/"/g, '""')}`)
                    .join('; ');
                
                // Format status
                const status = entry.isValid ? 'Valid' : (entry.warning ? 'Warning' : 'Invalid');
                
                // Format date
                const date = formatDate(new Date(entry.date));
                
                // Add CSV row (properly escaped for CSV format)
                csvContent += `"${entry.email.replace(/"/g, '""')}","${status}","${date.replace(/"/g, '""')}","${details}"\n`;
            });
            
            // Create and download the CSV file
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.setAttribute('href', URL.createObjectURL(blob));
            link.setAttribute('download', `email_validation_history_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        } catch (error) {
            console.error('Error exporting history:', error);
            showError('Failed to export history');
        }
    }
    
    // Add keyboard shortcuts for accessibility
    document.addEventListener('keydown', function(e) {
        // Escape key closes modal
        if (e.key === 'Escape' && historyModal.classList.contains('show')) {
            historyModal.classList.remove('show');
        }
    });
});
    </script>
</body>
</html>